<!DOCTYPE html>
<html>
    <head>
        <title>show svg</title>
        <script type="text/javascript" src="cj.js"></script>
        <script type="text/javascript">
        var kr = 39;
        var kl = 37;
        var index = 0;
        var view = document.getElementById('view');
        var prev = document.getElementById('prev');
        var next = document.getElementById('next');
        var stat = document.getElementById('stat');

        function adjustIndex() {
            var len = ws.length;
            if (index >= len) {
                index = index % len;
            }
            if (index < 0) {
                index = len - 1;
            }
        }
        
        function getAnswers(ch) {
            var alphas = Array('a','b','c','d','e','f','g','h','i','j','k','l','m',
                                'n','o','p','q','r','s','t','u','v','w','x','y','z');
            delete alphas[alphas.indexOf(ch)];
            alphas.sort(function() {return 0.5 - Math.random();});
            var answers = alphas.slice(0,3);
            answers.push(ch);
            answers.sort(function() {return 0.5 - Math.random();});
            return answers;
        }
        function updateView() {
            adjustIndex();
            view.src = ws[index];
            var chars = {
                'a':'日[A]','b':'月[B]','c':'金[C]','d':'木[D]','e':'水[E]','f':'火[F]',
                'g':'土[G]','h':'竹[H]','i':'戈[I]','j':'十[J]','k':'大[K]','l':'中[L]',
                'm':'一[M]','n':'弓[N]','o':'人[O]','p':'心[P]','q':'手[Q]','r':'口[R]',
                's':'尸[S]','t':'廿[T]','u':'山[U]','v':'女[V]','w':'田[W]','x':'難[X]',
                'y':'卜[Y]','z':'重[Z]'
                };
            var ans = getAnswers(ws[index].charAt(3));
            var ansTxt = '';
            for (var i = 0; i < ans.length; i++) {
                ansTxt += ' ('+(i+1)+')' + chars[ans[i]] + ' ';
            }
            stat.innerHTML = ws[index] + ansTxt;
        }
        
        function shuffle() {
            index = Math.floor(Math.random() * ws.length);
            updateView();
        }

        function init() {
            kr = 39;
            kl = 37;
            index = 0;
            view = document.getElementById('view');
            prev = document.getElementById('prev');
            next = document.getElementById('next');
            stat = document.getElementById('stat');

            updateView();

            prev.addEventListener('click', prevView());
            next.addEventListener('click', nextView());
            document.onkeypress = function(e) {
                e = e || window.event;
                var kc = e.keyCode;
                if (kc == kr) { //left
                    index ++;
                } else if (kc == kl) {//right
                    index --;
                }
                updateView();
            };
        }
        function prevView() {
            index--;
            updateView();
        }
        function nextView() {
            index++;
            updateView();
        }
        </script>
    </head>
    <body onload="init()">
        <div id=img><img id=view src="s2/a01.svg"></img></div>
        <table>
            <tr>
                <td span=3><div id=stat></div></td>
            </tr>
            <tr>
                <td><div id=prev><input type="button" value="prev" onclick="prevView()" /></div></td>
                <td><div id=prev><input type="button" value="shuffle" onclick="shuffle()" /></div></td>
                <td><div id=next><input type="button" value="next" onclick="prevView()" /></div></td>
            </tr>
        </table>
    </body>
</html>